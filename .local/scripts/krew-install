#!/usr/bin/env python3


import os
import subprocess
import sys


def read_plugins(file_name):
    """Read the list of plugins from the file."""
    with open(file_name, "r") as f:
        return [line.strip() for line in f]


def install_plugin(plugin):
    """Install a plugin using kubectl krew."""
    try:
        subprocess.run(["kubectl", "krew", "install", plugin], check=True)
    except subprocess.CalledProcessError:
        print(f"Failed to install plugin: {plugin}")


def main():
    # Check if the file name is provided
    if len(sys.argv) != 2:
        print("Usage: python script.py <file_with_plugin_names>")
        sys.exit(1)

    file_name = sys.argv[1]

    # Check if the file exists
    if not os.path.exists(file_name):
        print(f"The file {file_name} does not exist.")
        sys.exit(1)

    # Read the list of plugins from the file
    plugins = read_plugins(file_name)

    # Install each plugin
    for plugin in plugins:
        install_plugin(plugin)


if __name__ == "__main__":
    main()
